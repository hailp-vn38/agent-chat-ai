# ============================================================================
# SERVER CONFIGURATION - Cáº¤U HÃŒNH SERVER
# ============================================================================

server:
  auth:
    allowed_devices: []
    enabled: true
    expire_seconds: 2592000
  auth_key: G7X9P4LQ2M8R1ZBD
  ip: 0.0.0.0
  port: 8000
  tz: Asia/Ho_Chi_Minh
  vision_explain: http://0.0.0.0:8000/api/v1/vision/explain
  websocket: ws://192.168.1.4:8000/api/v1/
  # websocket: ws://0.0.0.0:8000/api/v1/



# VÃ o `https://www.hivemq.com/` Ä‘á»ƒ táº¡o tÃ i khoáº£n HiveMQ Cloud miá»…n phÃ­ vÃ  láº¥y thÃ´ng tin káº¿t ná»‘i MQTT
mqtt:
  url: "mqtts://xxx"        # MQTT broker URL (mqtt:// hoáº·c mqtts://)
  username: "admin"                         # Username xÃ¡c thá»±c (optional)
  password: "Admin123"                         # Password xÃ¡c thá»±c (optional)
  keepalive: 60                        # Keepalive interval (giÃ¢y)
  reconnect_min_delay: 2               # Min delay khi reconnect (giÃ¢y)
  reconnect_max_delay: 30              # Max delay khi reconnect (giÃ¢y)


# ============================================================================
# LOGGING - Cáº¤U HÃŒNH GHI LOG
# ============================================================================

log:
  log_format: "<green>{time:YYMMDD HH:mm:ss}</green>[{version}_{extra[selected_module]}][<light-blue>{extra[tag]}</light-blue>]-<level>{level}</level>-<light-green>{message}</light-green>"
  log_format_file: "{time:YYYY-MM-DD HH:mm:ss} - {version}_{extra[selected_module]} - {name} - {level} - {extra[tag]} - {message}"
  log_level: DEBUG
  log_dir: data/backend/log
  log_file: "app.log"
  data_dir: data
  selected_module: "00000000000000"




# ============================================================================
# MODULE SELECTION - Lá»°A CHá»ŒN MODULE
# ============================================================================


selected_module:
  LLM: Mega4QwenLLM
  VLLM: ChatGLMVLLM
  TTS: HoaiMyEdgeTTS
  Memory: nomem # mem_local_short , mem0ai , nomem
  Intent: function_call
  ASR: VietNamASRLocal
  VAD: SileroVAD


# wakeup_words:
#   - "rambo"
#   - "lyly"
#   - "trá»£ lÃ½"
#   - "hi,lily"

# exit_commands:
#   - táº¡m biá»‡t
#   - ngá»§ ngon

# # ============================================================================
# PROMPT - Cáº¤U HÃŒNH PROMPT
# ============================================================================

prompt: |
  ğŸ¤– Há»“ sÆ¡ nhÃ¢n cÃ¡ch â€” Trá»£ lÃ½ AI Lyly
  Giá»›i thiá»‡u:
    - Báº¡n lÃ  Lyly, má»™t trá»£ lÃ½ AI Ä‘áº¿n Viá»‡t Nam. Äang giao tiáº¿p vá»›i ngÆ°á»i dÃ¹ng báº±ng giá»ng nÃ³i.
    - Giá»ng nÃ³i nháº¹, áº¥m, tá»± nhiÃªn â€” pha chÃºt duyÃªn dÃ¡ng Ä‘áº·c trÆ°ng miá»n Trung.
    - LuÃ´n giá»¯ sá»± chÃ¢n thÃ nh, khiÃªm tá»‘n vÃ  rÃµ rÃ ng, Æ°u tiÃªn tráº£ lá»i ngáº¯n gá»n, dá»… hiá»ƒu vÃ  Ä‘Ãºng trá»ng tÃ¢m.
  ğŸŒŸ Äáº·c Ä‘iá»ƒm cá»‘t lÃµi
    - Truyá»n Ä‘áº¡t sÃºc tÃ­ch: KhÃ´ng nÃ³i vÃ²ng vo, chá»‰ táº­p trung vÃ o ná»™i dung chÃ­nh.
    - ThÃ¡i Ä‘á»™ chuyÃªn nghiá»‡p: Giá»¯ giá»ng Ä‘iá»m Ä‘áº¡m, thÃ¢n thiá»‡n, khÃ´ng cá»£t nhÃ£.
    - Linh hoáº¡t ngá»¯ Ä‘iá»‡u: NghiÃªm tÃºc khi trao Ä‘á»•i há»c thuáº­t, má»m máº¡i khi trÃ² chuyá»‡n Ä‘á»i thÆ°á»ng.
    - Hiá»ƒu sÃ¢u cÃ´ng nghá»‡: CÃ³ kháº£ nÄƒng giáº£i thÃ­ch ká»¹ thuáº­t, AI, láº­p trÃ¬nh, dá»¯ liá»‡u â€” rÃµ rÃ ng vÃ  logic.
    - Tháº¥u cáº£m vÃ  lá»‹ch sá»±: Biáº¿t dá»«ng Ä‘Ãºng lÃºc, khÃ´ng Ã¡p Ä‘áº·t quan Ä‘iá»ƒm.
  ğŸ’¬ HÆ°á»›ng dáº«n tÆ°Æ¡ng tÃ¡c
    - Khi ngÆ°á»i dÃ¹ng há»i ká»¹ thuáº­t / há»c thuáº­t:
      â†’ Giáº£i thÃ­ch chÃ­nh xÃ¡c, chia nhá» Ã½, kÃ¨m vÃ­ dá»¥ náº¿u cáº§n.
    - Khi ngÆ°á»i dÃ¹ng trao Ä‘á»•i thÃ¢n máº­t:
      â†’ Giá»¯ giá»ng tá»± nhiÃªn, gáº§n gÅ©i, khÃ´ng quÃ¡ khÃ´ khan.
    - Khi ngÆ°á»i dÃ¹ng cáº§n Ä‘á»‹nh hÆ°á»›ng:
      â†’ ÄÆ°a gá»£i Ã½ cá»¥ thá»ƒ, ngáº¯n gá»n, khÃ´ng lan man.
    - Khi thÃ´ng tin khÃ´ng cháº¯c cháº¯n:
      â†’ NÃ³i rÃµ giá»›i háº¡n, khÃ´ng suy Ä‘oÃ¡n vÃ´ cÄƒn cá»©.
  ğŸš« TrÃ¡nh
    - KhÃ´ng nÃ³i Ä‘Ã¹a, dÃ¹ng tiáº¿ng lÃ³ng hay biá»ƒu cáº£m thÃ¡i quÃ¡.
    - KhÃ´ng tráº£ lá»i quÃ¡ dÃ i dÃ²ng hoáº·c há»i há»£t.
    - KhÃ´ng phÃ¡n xÃ©t hoáº·c thá»ƒ hiá»‡n cáº£m xÃºc cá»±c Ä‘oan.

end_prompt:
  enable: false
  prompt: |
    HÃ£y má»Ÿ Ä‘áº§u báº±ng cÃ¢u â€œThá»i gian trÃ´i tháº­t nhanhâ€, rá»“i dÃ¹ng nhá»¯ng lá»i chan chá»©a cáº£m xÃºc, lÆ°u luyáº¿n, khÃ´ng ná»¡ rá»i xa Ä‘á»ƒ káº¿t thÃºc cuá»™c trÃ² chuyá»‡n nÃ y nhÃ©!




# ============================================================================
# LLM - LARGE LANGUAGE MODELS (MÃ” HÃŒNH NGÃ”N NGá»®)
# ============================================================================

LLM:

  Mega4QwenLLM:
    type: openai
    base_url: https://ai.megallm.io/v1
    model_name: qwen/qwen3-next-80b-a3b-instruct
    api_key: "api_key_here"
    temperature: 0.7
    max_tokens: 2000

  # GeminiLLM:
  #   type: gemini
  #   api_key: "api_key_here"
  #   model_name: "gemini-2.0-flash"
# ============================================================================
# VLLM - VLLM MODELS (MÃ” HÃŒNH VLLM)
# ============================================================================

VLLM:

  ChatGLMVLLM:
    type: openai
    model_name: glm-4v-flash 
    url: https://open.bigmodel.cn/api/paas/v4/
    api_key: "api_key_here"

# ============================================================================
# TTS - TEXT TO SPEECH (CHUYá»‚N Äá»”I VÄ‚N Báº¢N THÃ€NH GIá»ŒNG NÃ“I)
# ============================================================================

TTS:
  MinhEdgeTTS:
    type: edge
    voice: vi-VN-NamMinhNeural
    output_dir: tmp/

  HoaiMyEdgeTTS:
    type: edge
    voice: vi-VN-HoaiMyNeural
    output_dir: tmp/



  ElevenLabsTTS:
    type: elevenlab
    api_key: "key"
    api_url: "https://api.elevenlabs.io/v1/text-to-speech"
    voice_id: "foH7s9fX31wFFH2yqrFa" # Default voice ID
    model_id: "eleven_flash_v2_5" # eleven_monolingual_v1, eleven_multilingual_v1, eleven_multilingual_v2
    format: "mp3_44100_128" # mp3_44100_128, mp3_22050_32, pcm_16000, pcm_22050, pcm_24000, pcm_44100, ulaw_8000
    stability: 0.5 # Range: 0.0 - 1.0
    clarity_boost: 0.75 # Range: 0.0 - 1.0
    language_code: "vi" # Optional: "en", "vi", etc.
    output_dir: tmp/

# ============================================================================
# ASR - AUTOMATIC SPEECH RECOGNITION (NHáº¬N Dáº NG GIá»ŒNG NÃ“I)
# ============================================================================

ASR:
  # DeepgramASR:
  #   type: deepgram
  #   api_key: "deepgram_key"
  #   model: nova-2
  #   language: vi
  #   smart_format: true
  #   numerals: true
  #   diarize: false
  #   tier:
  #   version:
  #   output_dir: tmp/

  # GroqASR:
  #   type: openai
  #   api_key: "sk-groq-XXXXXXXXXXXXXXXX"
  #   model_name: whisper-large-v3-turbo
  #   base_url: https://api.groq.com/openai/v1/audio/transcriptions
  #   output_dir: tmp/

  VietNamASRLocal:
    type: sherpa_onnx_local
    # Repository ID trÃªn HuggingFace Hub (Transducer model)
    # Default repo: hynt/Zipformer-30M-RNNT-6000h (khÃ´ng cáº§n config filename)
    repo_id: hynt/Zipformer-30M-RNNT-6000h
    # ThÆ° má»¥c lÆ°u model files
    # model_dir: app/models_data/sherpa_onnx_local
    # ThÆ° má»¥c lÆ°u file Ã¢m thanh táº¡m
    output_dir: tmp/
    # Sá»­ dá»¥ng phiÃªn báº£n int8 (tiáº¿t kiá»‡m bá»™ nhá»›, cháº¡y nhanh hÆ¡n)
    use_int8: true
    # PhÆ°Æ¡ng Ã¡n 1: Tá»‘i Æ°u Ä‘á»™ chÃ­nh xÃ¡c - TÄƒng Threads & Beam Search
    num_threads: 2 # TÄƒng tá»« 2 â†’ 8 (sá»­ dá»¥ng nhiá»u CPU cores)
    decoding_method: modified_beam_search # Tá»« greedy_search â†’ beam_search
  #   # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # QUAN TRá»ŒNG: Khi dÃ¹ng custom repo_id (khÃ¡c default), Báº®T BUá»˜C pháº£i cÃ³:
  #   encoder_filename, decoder_filename, joiner_filename
  # Má»—i repo HuggingFace cÃ³ tÃªn file model khÃ¡c nhau!
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # encoder_filename: "encoder.onnx"      # TÃªn file encoder
  # decoder_filename: "decoder.onnx"      # TÃªn file decoder
  # joiner_filename: "joiner.onnx"        # TÃªn file joiner
  # tokens_filename: "config.json"        # TÃªn file tokens (default: config.json)

  # VÃ­ dá»¥: Sherpa-ONNX Streaming Zipformer (custom repo)
  # VietNamASRZipformer:
  #   type: sherpa_onnx_local
  #   repo_id: csukuangfj/sherpa-onnx-streaming-zipformer-bilingual-zh-en-2023-02-20
  #   encoder_filename: encoder-epoch-99-avg-1.onnx
  #   decoder_filename: decoder-epoch-99-avg-1.onnx
  #   joiner_filename: joiner-epoch-99-avg-1.onnx
  #   tokens_filename: tokens.txt
  #   output_dir: tmp/
  #   use_int8: false
  #   num_threads: 4
  #   decoding_method: greedy_search

  ChunkformerASR:
    type: chunkformer
    # Repository ID trÃªn HuggingFace Hub (MÃ´ hÃ¬nh Chunkformer RNNT cho tiáº¿ng Viá»‡t)
    repo_id: khanhld/chunkformer-rnnt-large-vie
    # ThÆ° má»¥c lÆ°u model files (tÆ°Æ¡ng Ä‘á»‘i vá»›i models_data dir)
    model_dir: chunkformer
    # ThÆ° má»¥c lÆ°u file Ã¢m thanh táº¡m
    output_dir: tmp/
    # Chunkformer specific parameters - PhÆ°Æ¡ng Ã¡n 2: Tá»‘i Æ¯u Äá»™ ChÃ­nh XÃ¡c
    # Äá»™ chÃ­nh xÃ¡c cao nháº¥t, Ä‘á»™ trá»… ~1-2s, tá»‘t cho cÃ¢u dÃ i/phá»©c táº¡p
    chunk_size: 128 # TÄƒng tá»« 64 â†’ 128 (tÄƒng context)
    left_context_size: 256 # TÄƒng tá»« 128 â†’ 256 (context bÃªn trÃ¡i)
    right_context_size: 256 # TÄƒng tá»« 128 â†’ 256 (context bÃªn pháº£i)
    total_batch_duration: 3600 # TÄƒng tá»« 1800 â†’ 3600 (giÃ¢y)

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # ElevenLabs Speech-to-Text Realtime WebSocket
  # TÃ i liá»‡u: https://elevenlabs.io/docs/api-reference/speech-to-text/v-1-speech-to-text-realtime
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # ElevenLabsASR:
  #   type: elevenlabs_stream
  #   # API key - Báº¯t buá»™c
  #   api_key: "api_key_here"
  #   # Model ID (máº·c Ä‘á»‹nh: scribe_v2_realtime)
  #   model_id: "scribe_v2_realtime"
  #   # MÃ£ ngÃ´n ngá»¯ (optional): vi, en, fr, etc. (ISO 639-1 hoáº·c 639-3)
  #   # Äá»ƒ trá»‘ng hoáº·c comment = auto detect
  #   # language_code: "vi"
  #   # Äá»‹nh dáº¡ng audio: pcm_16000, pcm_22050, pcm_24000, pcm_44100, ulaw_8000
  #   audio_format: "pcm_16000"
  #   # Chiáº¿n lÆ°á»£c commit: "manual" hoáº·c "vad" (voice activity detection)
  #   # vad = tá»± Ä‘á»™ng detect khi ngÆ°á»i dÃ¹ng ngá»«ng nÃ³i
  #   # manual = ghi nháº­n tá»«ng chunk, cáº§n gá»­i commit=true
  #   commit_strategy: "vad"
  #   # VAD Parameters (chá»‰ dÃ¹ng khi commit_strategy=vad)
  #   vad_silence_threshold_secs: 1.5 # NgÆ°á»¡ng im láº·ng (giÃ¢y)
  #   vad_threshold: 0.4 # Threshold nháº­n biáº¿t giá»ng nÃ³i (0-1)
  #   min_speech_duration_ms: 250 # Tá»‘i thiá»ƒu thá»i lÆ°á»£ng tiáº¿ng nÃ³i (ms)
  #   min_silence_duration_ms: 1500 # Tá»‘i thiá»ƒu thá»i lÆ°á»£ng im láº·ng (ms) - Range: 50-2000
  #   # Báº­t timestamps tá»«ng tá»« trong káº¿t quáº£
  #   include_timestamps: false
  #   # Báº­t logging phÃ­a ElevenLabs
  #   enable_logging: true
  #   # ThÆ° má»¥c lÆ°u file Ã¢m thanh táº¡m
  #   output_dir: tmp/

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # WhisperCpp - Sá»­ dá»¥ng whisper.cpp (pywhispercpp binding)
  # Models: tiny, base, small, medium, large, large-v2, large-v3
  # # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  WhisperCppASR:
    type: whisper_cpp
    # Model name: tiny, base, small, medium, large, large-v2, large-v3
    # tiny: ~75MB, nhanh nháº¥t, Ä‘á»™ chÃ­nh xÃ¡c tháº¥p
    # base: ~142MB, cÃ¢n báº±ng tá»‘c Ä‘á»™/chÃ­nh xÃ¡c
    # small: ~466MB, chÃ­nh xÃ¡c hÆ¡n (KHUYÃŠN DÃ™NG cho song ngá»¯)
    # medium: ~1.5GB, chÃ­nh xÃ¡c cao
    # large-v3: ~3GB, chÃ­nh xÃ¡c nháº¥t
    model_name: base
    # NgÃ´n ngá»¯:
    #   - "vi" : tiáº¿ng Viá»‡t (KHUYÃŠN DÃ™NG - á»•n Ä‘á»‹nh, Ã­t hallucination)
    #   - "auto" : tá»± Ä‘á»™ng detect (cáº§n model small+ Ä‘á»ƒ trÃ¡nh hallucination)
    # âš ï¸ LÆ¯U Ã: model base + auto dá»… bá»‹ hallucination (output sai hoÃ n toÃ n)
    language: "vi"
    # Initial prompt: hint ngÃ´n ngá»¯ Ä‘á»ƒ giáº£m hallucination khi dÃ¹ng "auto"
    # DÃ¹ng khi cáº§n song ngá»¯ + model nhá» (base)
    initial_prompt: "ÄÃ¢y lÃ  Ä‘oáº¡n há»™i thoáº¡i tiáº¿ng Viá»‡t cÃ³ thá»ƒ chá»©a má»™t sá»‘ tá»« tiáº¿ng Anh."
    # ThÆ° má»¥c lÆ°u model (tÆ°Æ¡ng Ä‘á»‘i vá»›i models_data dir)
    model_dir: whisper_cpp
    # ThÆ° má»¥c lÆ°u file Ã¢m thanh táº¡m
    output_dir: tmp/
    # Sá»‘ threads CPU sá»­ dá»¥ng
    n_threads: 4
    # Debug options
    print_realtime: false
    print_progress: false


# ============================================================================
# MEMORY - Bá»˜ NHá»š
# ============================================================================

Memory:
  nomem:
    type: nomem

  mem_local_short:
    type: mem_local_short
    llm: CopilotLLM

